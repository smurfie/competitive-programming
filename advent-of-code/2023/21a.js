(() => {
  function solve(input, steps) {
    let lines = Utils.read(input);
    let map = lines.map((i) => i.split(""));
    let x = -1;
    let y = -1;
    for (let i = 0; i < map.length; i++) {
      for (let j = 0; j < map[0].length; j++) {
        if (map[i][j] === "S") {
          x = i;
          y = j;
        }
      }
    }

    let par = (x + y + steps) % 2;
    let positions = [[x, y]];
    for (let n = 0; n < steps; n++) {
      let positions2 = [];
      for (let position of positions) {
        for (let [i, j] of [
          [position[0] - 1, position[1]],
          [position[0] + 1, position[1]],
          [position[0], position[1] - 1],
          [position[0], position[1] + 1]
        ])
          if (
            i >= 0 &&
            i < map.length &&
            j >= 0 &&
            j < map[0].length &&
            map[i][j] === "."
          ) {
            map[i][j] = "S";
            positions2.push([i, j]);
          }
      }
      positions = positions2;
    }

    let sum = 0;

    for (let i = 0; i < map.length; i++) {
      for (let j = 0; j < map[0].length; j++) {
        if (map[i][j] === "S" && (i + j) % 2 === par) {
          sum++;
        }
      }
    }
    return sum;
  }

  let dataset = [];

  dataset.push({
    input: `...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
...........`,
    steps: 6,
    output: 16
  });

  dataset.push({
    input: `...................................................................................................................................
...#........#..#.#....#.....#..........#......#..........#...........................#.................#...#.#.....................
................#....#.........#.#...#............#..#....#..................##..........#........#.....#....###..#....#...........
.#...........##..............#...#.........#..............#.................#...............#...................................##.
..#...........#...........##....##.............#.....#.........................#................#..........................#.......
..............#......................#...........#..#...#......................#.............#.......#.............................
...........#..#..............#.#.....#...........................................#.....###..............#.#..............#.......#.
.......#....#............#......#....#.............................................#.....#.........................................
....##.........##......##.........##.........#....#............#.............#...#..#....#...................#.........#.#.........
..#...........#...#.#.........................................................#.....#.#...#.####.......##...................#...#..
.......#....##...................#..#......#....#...................#..........#...............#.............#.......#..#..........
.................#.#.#####....#....#....##.#...............#...#.....#.#..............#...................#...#................#...
...........................#.....#...#.......................#....##.....................##....#..#..#.............................
...#.#...............................................................#.#................#.#.......................#................
....##.................................#.#.....#......................#....................#........#.................#.#..#.......
.....#.........#.#...#..........#..#.#......#........................................#.................#..........#.##..........#..
.........#......#....#..#...................#............................#.............................#...#.......#...............
.#.#.........#...#..........#..#.........#..#...............##......##...#...........................#........#....................
......#......................#.........#....................#.#............#.#............#.............#........#...#.#.........#.
........#....#..................#......................#......#.#.......#..............................##...............#..........
.#.......#...#.#..#..................................#............#..#...#..................#.#...#.#..............#...#.....#.....
..#.....#...##..#......#.......#......#..............#....#..........#..........#.#.............#.....#.......#...#..###.##........
...................#..#.....#.......................#.......#............#.....#..#.........#....#....#....#.................#.....
........#.......###....##.......#.....#........#........#..##.....#.......##...#...#........#..............#.#.....................
...............#......##..............................#............#..........#...###...................#.#..................#.....
..#...#..#.#.#.#..........#.#...#..#.....................#..#.....#...........#...............#..............#..#..........#..#....
........#........#..#.......##.##..........##................##............#........#...........................#..#...#...##...#..
......#.#..#..#..........#.#...................#......#..............#.....#...........#..............##...........#...............
.....#...#...#.......##...........................#................#....#............#...........#.....#......#........##..........
..#.#........#..#.#...#.....#............#..................................#.............#................##....##................
......#.......#......#..........................#.........#.#.............#..#.......#...................#..#......................
......................#..................#.............#...#................#..........................#.##........#....#..........
..#....#.##...............#.............#.............................#.#..###.#...........#............................#..........
.....................................#.....#...#...#..#........#.....................#.#..#...#........#.....#.................#.#.
.....................#.....................#........................#..........#...#.....#..............#......#.................#.
.........#...#......#..#......................#.........#............#.........#........................#...#..###.#.....#..#......
.............#..#.......#..........#.............#.#...#.#.#....#...........#......................................................
.....##....#.......................#......................#...#.#..............................#..................##..#............
.....#.........#..........................#.........#.............#...#....#............#....#...............#...#..##.........#...
..#................................#......##..##..#.......#..#..................#.....................................#.#...#......
.....................#..........#.#...........#..............#.............#.#......................#...........#.###..............
......##.#.#.............................##........#.............................#.....#.....#.......................#.............
................#..............................#....#...................#.##......#...................#...........#....##..........
.#............#.....................#.....#...............................#.#.........#.............#...#........#.................
.#.........##...................##..............#..........#.#................#.......................#........................#...
..#............#.................#..............#..........##.....#..##..........#............#.......................#............
....#.#.......#.........#.............#.......#......##....#............#................#........#................#..........#....
..............................#....###......#..#..#....................##..........#.#.##.......#.........................#...##...
........#............#...##.....................##..#......##......#..........#......#...............................#.#...#.......
.....#.#.#............#....#....#.....#.......#.#....#.........#......#..................#.#..#..........................#.........
.........#...........................#.....#..#.......#.....#...#........#......#...................#.........#....................
....#....#............#........#..................#.......................#..#.##..............#................#..........#.......
...###...............##..............#.......##..#.#.....#.....#.......#...#.......##......................##...#...........#.#....
.......................#.....#.........#..........#......#...............#.....#.....#....#.........#..#.........#.................
................................................#.#.#....#......#...#..............#........#.#....#..........#.............#......
.#....#..................#.....#...#.......#......................#..#.........................#..#...........##....#..............
.....................##................#.#....#......#......#......#....#...#....................#..........##.....................
....#................#....#..........#.#.....................#.......#...#......#........#.#.#..........#...........#..........#.#.
..#..................#.................#..#....#.#.#.....#.#...#.......#..#......................#...................#.............
..#.............##.........#..#.......#......#.............#................##..................#...#......#............#..........
............#.....##.............#..#...#....###...#.........................#..#.#........#..................#......#.............
....................#.#........#.......#.........#....##......##....#...#.#.##.#..#...#...............#...#.......#....#...........
..................................#...#.........#..............#........#.............#...........................#.......#........
..............##.......#.............#.#.........#..#.#.....................#.......................##...##..#.........#...........
..........#.....#.#..##....#..................#....#.......#............#.........#...#........#..................#.......#........
.................................................................S.................................................................
..............##.#.....................#...........##..##.......#............#....#.#.........#..#.....................##...#......
...........................#.#...##..##............#......#............#...........#.#.#......#...#......................#.........
....................#...........#...........#.........#.......................#.........#......##...........#...........#..........
..................#......#.........................#.....###.......#................#..#.........#.........####..........#.........
.................#......#....................#.#.#..........###.......................#...#.......#...#................#.#.........
.......................#..#........#..##...#...........#.......#.......................#............#...#.....#.#..................
...............#.....................#..#..#................#.#...........#...#......#......#..#.....#.........#.......#...........
.#.................#........#.........#......#.....................#......................#..........................#..........#..
................##......#..........#.....#..........#.........#....................#....#...........#..#.....#.....................
.......................................#.......................#......#...........................#...#............................
..............................#..............................#.....#...............#..............#...#....#................#....#.
...#..#...........#...........##........##...........#.#.......................#..........#.#.......#...#..................##......
.....#.............##........#.#.#.............#.......#............#.....#.........#.............#......................#...#.#...
........#.....................#..........#......................#.............#.#.............#........#...........................
..........................#..........#...............#.............#.....##...#.#......#.........#.......#.............#...........
.#.....#..........................#.#..#..#..............#................#.............##..................................#......
...........#...................##.........................#.....#......#...#....#...............#............#.............##.#....
...#...........................#................#..#......#...#.............#..#.....#.............................................
.......##..#..............#.#....................#.....#.............#....................#............#.#....................##...
.##.#..........#........#.....................#.#.......#..#..#..........##...........................................#.......#....
..............#..#........#......#.................#.....#.........#.......#..............#..........##.....................#......
...........#...#.............#........#......#........#.........#......#.....#.....#....................#...........#..........#...
.#...............................#...#.....#.##........#............#...#...#..#................#.......................##.......#.
.........#.#...............................................#...#.....#.........................................#....#..............
.....#..#...#...................#................#......#.#....................#......#...#.....#............#.......#..........#..
..............#.....................#.....................................#.......#..#......#..................#.......#.....#.....
....#....#...#...##................#..#.......#..#................#..#..............#...........#..........#.##......#....#...#.#..
...#........#.........#..........#..#......#.....#..........................#........#................................#............
.........#........#..................................#..........................#.........................#....#......#............
.#..................................................#....##....#....#...#..#...#..........#.......................#................
........#...#............................##.........................#.....#...##...#.........#............#.........#..............
...#.#.......#.......................#.....#..............#...#.............#...#......................................#...#....#..
....#.......#..#......................##...#....##....#............#.........................................#.....................
.......#....................#.........#...............#.....#.#....#................#...#................#........#................
..#...#....#......#......#....#........#..##....#....##..#..##.#..#.....................#..........#.......#................##.....
......#.#............#....................#.....#...............#...#...............#...............###.#......#.........##........
..................#........................##..#.......#....#......#.................#.............#......#....#....#......#...#...
...#..#.......#....#...........#.....................#......................#..........#..........#........##......................
.....##.....#.....#...#...#..........................##....................##..#.....................#......##.........#.....#.....
....##.......##.#..#..#.........#...#.............#.....#..................................................#.#.........#....#......
..........#..#.##..............#.................#..............#......#.#.##.......#.........................#....#.............#.
...........#.......................#..............#..##.....#...#.#.........................................##........#....#.....#.
..............#..#...................................#...................#.....#..............#...........#.........#..#...........
..........#.#...................#...............#.....................#..........#.........................#.#.....................
........##...#......#.#...##..#.....#................#............#........#....#..............#....#.....................#........
.................#..#..#..#.................................#................#.....................#....................#..#.......
...............#......#...#....#.#..#.#......................#........##..........................##...........................#...
.............#....................#.#.........................#....#......#.............###........#...#........#....#....#........
............................#....#.............................#.............#.........##..#....#.....##...........................
..#............#.#......#.............................#.........#..#.......................#.......................................
..#........#..#....#.......#...#..........#............#....#.#.......#.............#......................##.....#................
.........##.#.............#...............................#.............................#.........................#.....#..........
..............#...#......#..###...................................#.....................................#..#...#...............#...
.....#.#...............#.........................#..............#.....#..........................#.#.............#..#......#.......
...#...###..#........#........#.............##................#....#...................................#..#...##....##.............
.....#.............#...............#..#...##.....#...................#............#..................#..##...............#.#.......
.....#....#........#.#..#.........#.........#.......#...................................#.................#.........#......#.....#.
......#...........................#....#..............#.........#.............................#.......................#.....#......
......#....#...#.......#.#......#..##...........#...........................#...#.#..#........................................##...
.....................................................#.....................#........#.......#......#........#.##.........#..#....#.
...........#.#.....#......................#...#....................................#..................#.............#......#.......
.#.....#.#.......................#......#..#................................#.......#...........##.........#....#..#......#..#.....
..........................##..#.............#........#.............................###........................#.#..........#.#.....
.....#..........#.#....................#...#......#........................#.#.....#..............##.................#.........#...
...................................................................................................................................`,
    steps: 64,
    output: 3816
  });

  Utils.check(solve, dataset, "21a");
})();
