(() => {
  const RIGHT = 0;
  const DOWN = 1;
  const LEFT = 2;
  const UP = 3;

  function solve(input) {
    let lines = Utils.read(input);
    let map = lines.map((i) => i.split(""));
    let map2 = [];

    for (let k = 0; k < 4; k++) {
      map2.push([]);
      for (let i = 0; i < map.length; i++) {
        map2[k].push([]);
        for (let j = 0; j < map[i].length; j++) {
          map2[k][i].push(false);
        }
      }
    }

    go(0, 0, map, map2, RIGHT);

    let sum = 0;
    for (let i = 0; i < map.length; i++) {
      for (let j = 0; j < map[i].length; j++) {
        if (map2[0][i][j] || map2[1][i][j] || map2[2][i][j] || map2[3][i][j]) {
          sum++;
        }
      }
    }
    return sum;
  }

  function go(x, y, map, map2, direction) {
    if (
      x < 0 ||
      y < 0 ||
      x >= map.length ||
      y >= map[0].length ||
      map2[direction][x][y]
    ) {
      return;
    }
    map2[direction][x][y] = 1;
    switch (map[x][y]) {
      case ".":
        switch (direction) {
          case RIGHT:
            return go(x, y + 1, map, map2, direction);
          case DOWN:
            return go(x + 1, y, map, map2, direction);
          case LEFT:
            return go(x, y - 1, map, map2, direction);
          case UP:
            return go(x - 1, y, map, map2, direction);
        }
      case "/":
        switch (direction) {
          case RIGHT:
            return go(x - 1, y, map, map2, UP);
          case DOWN:
            return go(x, y - 1, map, map2, LEFT);
          case LEFT:
            return go(x + 1, y, map, map2, DOWN);
          case UP:
            return go(x, y + 1, map, map2, RIGHT);
        }
      case "\\":
        switch (direction) {
          case RIGHT:
            return go(x + 1, y, map, map2, DOWN);
          case DOWN:
            return go(x, y + 1, map, map2, RIGHT);
          case LEFT:
            return go(x - 1, y, map, map2, UP);
          case UP:
            return go(x, y - 1, map, map2, LEFT);
        }
      case "|":
        switch (direction) {
          case RIGHT:
            go(x + 1, y, map, map2, DOWN);
            return go(x - 1, y, map, map2, UP);
          case DOWN:
            return go(x + 1, y, map, map2, DOWN);
          case LEFT:
            go(x + 1, y, map, map2, DOWN);
            return go(x - 1, y, map, map2, UP);
          case UP:
            return go(x - 1, y, map, map2, UP);
        }
      case "-":
        switch (direction) {
          case RIGHT:
            return go(x, y + 1, map, map2, RIGHT);
          case DOWN:
            go(x, y + 1, map, map2, RIGHT);
            return go(x, y - 1, map, map2, LEFT);
          case LEFT:
            return go(x, y - 1, map, map2, LEFT);
          case UP:
            go(x, y + 1, map, map2, RIGHT);
            return go(x, y - 1, map, map2, LEFT);
        }
    }
  }

  let dataset = [];

  dataset.push({
    input: `.|...\\....
|.-.\\.....
.....|-...
........|.
..........
.........\\
..../.\\\\..
.-.-/..|..
.|....-|.\\
..//.|....`,
    output: 46
  });

  dataset.push({
    input: `\\.|...|...-/..........-.............|./..........\\...................\\.-......-...../..../.........-../.......
................-...........................................\\...................|......-......................
.\\..........|...|............................|..............\\................../......\\..................|....
\\...-..|......--..............|.................................|................\\..........-........-......-.
............\\......./.........................\\........../..../............\\......./.........................-
.........|............................/...................-................-../.\\|.................-..\\.......
.......................|............................/.../\\-.....-....-\\-|.........-/|....\\........\\.........\\.
.\\-............................../.....................................|................|....................|
....../...........................\\......././-.........|............................................/.........
.............|................/......|......./.|...|.....................|....................................
.......|.............\\...............\\.....|.....\\......................\\.............-.......|...../.........
|........-........-...\\...........|............|......-.|.......|.................|............/......-.......
..............\\...............\\......-........|../........................../..................|/.........|...
............\\.../................\\.....................\\...|............/.........................\\.....\\.....
...../......./......../............|......\\...\\...........\\.........-...............-..................\\..|...
................\\....\\.|...............-......-..../.-\\......................-.........|......................
.............../................\\.............//.....\\...................................-....\\......../......
...............\\.............................\\...-..\\.......\\.\\.................|..............||/............
.........../........./...././...........................\\..../........-.......|.--.......................|.|..
..\\............/..|......|.\\.|/...............|......|........./.|.....................................\\......
..........||........-...../.........................................-.............../.....................\\...
................|........../..........................-....-../...................................\\........-..
.............................-..-.................../..-...-.......|..................|......../............./
................\\......................\\........./...-...\\|.............\\..|.....|............|/...........-..
............|/../..-.................|./.......................\\..............................................
.................................../.........-..-..-...-............-....-....\\...........\\..\\.|....-.........
..../.......|..................-.....|./.-......-|............................................................
......../........................./.-./.............................................\\.....\\-\\..|....../.......
-...........................-.\\........-........|......|.........|....-....|......|......\\..............-./...
./....-/.........-.................\\.......\\......./..............|.........||.|...........-..........-..|...|
...........................|........||................|..../.-.|...............-..............................
../.../................................../...-..........-.................../.../.............................
.................-.../..............\\-........-/...../........................................./.....|../.....
....................\\..//.....|...\\............/................./...................-.......\\\\..........-....
....-.\\..-...........\\.............................\\.......................\\.................|.......|.......|
.|.../.............................\\.-......\\.............../.../................/....|.......................
...................-.|.............|............../.......................................|.................|.
\\......................../.....-......|....|..............\\\\............|....................\\......./........
...../..........|.................\\.....\\.../..............--....|.|.............................-............
....\\...|........./................\\......................................................./....../...-...\\...
......-......................|../.......\\.....|../...|..\\...................|..\\.........../....\\|...........-
/.........-..........-..\\..................\\....-....../.-.........|.................\\......./...-.|......../.
......-..|\\................../../...|.|...................../........................\\.|-/....................
......../..............\\...............................-....|/....../.\\.......\\..-..../...../....\\..//........
..\\..|./.......|................../...../.........\\.........../..\\\\...|.........................\\|............
|..|............../.....\\..-................/................\\............|\\..................................
...\\.../...\\.................|.....................|.............|............................................
|.-...\\.......-............../....-....../..-./..../.....-............|...|......|..-...\\./....\\/-....\\.......
..........|...............\\.\\...............................\\...../...........-\\.........\\./.............../..
.../....../....-.........-...\\./...........\\....|............-..........-|.....|...|..-./.........../.........
/\\................\\..|............./..-..../.....................\\..............\\...|.............|........../
\\.............\\...............................\\.........-..\\....../.-............\\/..../.\\...\\...\\\\...........
.............\\/...\\.\\................................\\.-..................../....\\....................//..-...
..|../.../....................................|........\\............................|.............../.........
............/..............\\..../..|.-......\\.\\..|...............\\..-.....|.............../.../\\.......|......
...............\\....\\...............................-.|....|..............-.......|..........-......\\.........
..|.....\\...............-........./.......................-...|..........\\./.....\\...../................|.....
..\\.........|..............-.....|.-............\\.................\\.........................|........||.......
/...............-./..........|...\\...................................-...\\......-.../....../.....|............
................................./.-..................-.........................-.............|.........\\./...
..|.|.....................-............|/...................\\............/.-......-.....\\../.|.....|..........
..-./......|............../....-......\\..............|-.....................\\................-............\\...
............................/...........|.-.\\..../.\\.......\\............|.....................................
........................|........................................................../....\\..-........|...|.....
....-............\\............................\\......|.........|\\.............../-...........|......\\.-.|...|.
.....\\........../.....|......-././.......\\.-............-/..........-....././..-......|...|-........|.........
.........-.|......../....\\|...-........||....../........|-....|.........................|................-.-..
..-.........--.........../...\\...............................\\..|../...\\..../.../..................|...-....\\.
.................\\.../...........-..........|..../...............|.............|..........||.........\\........
......./-..../................\\../-................................/...............|.......|.\\.......-.....|..
../..-........./.|..\\..\\..../.\\............/......-.|....\\.....-...................................../.-....|.
......./........../..........|...../....................\\../...\\....................-......\\......|......../..
.....\\...-.....-\\...................|....../.....-.....................\\......................................
.....-......./............-........................../....|.................-..........|..............\\.......
....//.........................|.......|...|................./........-...........|......|-.....././..........
.........../.........|-....................................\\.-....|...-....................|.../..........//..
.................................\\/......................................\\..||.......................\\........
.............................../.........\\.......-...|...................................\\.|..........|.......
.......-\\.........|......./.............................|..|...................-.../....../\\.....\\............
...................\\.....\\.-......../......|......-...\\.|........|.../...................................\\....
........................\\.......-..|/....-../.........-..-....\\............./../.........\\................../.
..-.-......-....-..-.....-........|..../...........................||-/................./.|......./.../....-..
......|....|....|../...........-.|....-........|........-.......|.............\\.......-|..-......-../..-......
...-......-|...\\...................|..-..../...||....-..........|./.../.|...\\........|./.......|./\\|..........
.................-\\|./..................|...........................\\.............|...../.........|.....\\.....
...\\.\\....................//..................-......-...................\\.....\\.......................\\......
........./.................|..-........../.........|..|........../..|..\\.........-/........\\.-................
.../.\\....|....../.../............................-.......\\...........|.....|....-.-........./......../.......
........|...............|.......-...|..-.......\\.-.........|......-...|..................-....................
......\\./.../..................................\\.............|......./../..\\.......-....../...-..|..\\..\\......
/......./...-............/\\..|.............-......\\.....-.......-....|......../..........-....................
.\\.|..../.....--........-....-.../.............|................................|.........-.\\.....-..|........
.-.....................-.|.............................../..\\...........|.................|./......-..........
......................................\\.......\\..............................-.........|......-........|......
........../....|...........|...|.\\...\\......................../.............|......../......../....-.-.....-..
....\\....|.............................../\\........................../......-......................|.......-..
\\../..........|.....................|.../...-...../.\\......\\.\\........-..............|........-....-..\\.......
....................|...............-........./........-.-........||............\\..................|.....-....
........-|...........|.-..|.................\\../.............................\\./.................\\............
..........-.\\..../.......\\.....................-................../.............\\........-....\\|./............
....................................../...-...|.|...............................|......./.......-.............
............../............/............./............\\...../..................../...\\.-......................
.|/..........|.\\....................|...../.........|...................................\\...|\\..\\.............
.\\......././|............/...\\...\\...............-......../../..........................-./.........-.........
.-............|.........................-|............|.....-............\\...........|........-...............
..-...............-......../............../.........././....../......-..............-......\\.//-..............
...-.|................................../.....\\....-...............-............-..........-........../...\\...
....................-.....-.........-\\....\\....-./......................................./..............-.\\\\./
.............../.|........-......-..........................\\./........\\...\\...|.-..............\\.....-......|
...../......\\................//........-..............-...........-...................\\./....\\..............-.`,
    output: 7392
  });

  Utils.check(solve, dataset, "16a");
})();
