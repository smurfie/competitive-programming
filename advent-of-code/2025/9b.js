(() => {
  function solve(input) {
    let lines = Utils.read(input);
    let maxArea = 0;
    let vertices = lines.map((line) => {
      let [x, y] = line.split(",").map(Number);
      return { x, y };
    });

    // The idea is making and outside shape at 0.1 units away from the original shape
    // and then checking if the edges of the rectangle intersect with any of the outside edges
    let horizEdges = [];
    let vertEdges = [];

    let edges = [];
    let outsideEdges = [];
    calcEdges(vertices, edges, outsideEdges);

    for (let i = 0; i < vertices.length - 1; i++) {
      let v1 = vertices[i];
      for (let j = i + 1; j < vertices.length; j++) {
        let v2 = vertices[j];
        let [xMin, xMax] = [Math.min(v1.x, v2.x), Math.max(v1.x, v2.x)];
        let [yMin, yMax] = [Math.min(v1.y, v2.y), Math.max(v1.y, v2.y)];
        let area = (xMax - xMin + 1) * (yMax - yMin + 1);
        if (
          area > maxArea &&
          !intersects(xMin, yMin, xMin, yMax, outsideEdges) &&
          !intersects(xMin, yMax, xMax, yMax, outsideEdges) &&
          !intersects(xMax, yMax, xMax, yMin, outsideEdges) &&
          !intersects(xMax, yMin, xMin, yMin, outsideEdges)
        ) {
          maxArea = area;
        }
      }
    }

    return maxArea;
  }

  function calcEdges(vertices, edges, outsideEdges) {
    let min = Infinity;
    let minPos = -1;

    for (let i = 0; i < vertices.length; i++) {
      let [x1, y1] = [vertices[i].x, vertices[i].y];
      let [x2, y2] = [
        vertices[(i + 1) % vertices.length].x,
        vertices[(i + 1) % vertices.length].y,
      ];
      edges.push({ x1, y1, x2, y2 });
      if (x1 < min && x1 == x2) {
        min = x1;
        minPos = i;
      }
    }

    let { x1, y1, x2, y2 } = edges[minPos];
    let x1Out = x1 - 0.1;
    let x2Out = x2 - 0.1;
    let y1Out = y1;
    let y2Out = y2;
    if (y1Out > y2Out) {
      y1Out = y1 + 0.1;
      y2Out = y2 - 0.1;
    } else {
      y1Out = y1 - 0.1;
      y2Out = y2 + 0.1;
    }
    outsideEdges.push({ x1: x1Out, y1: y1Out, x2: x2Out, y2: y2Out });

    for (let i = 1; i < edges.length; i++) {
      let pos = (minPos + i) % edges.length;
      let nextEdge = edges[pos];
      let nextEdge2 = edges[(pos + 1) % edges.length];
      let x1Next = nextEdge.x1;
      let y1Next = nextEdge.y1;
      let x2Next = nextEdge.x2;
      let y2Next = nextEdge.y2;
      let x2Next2 = nextEdge2.x2;
      let y2Next2 = nextEdge2.y2;

      let x1Out = x2Out;
      let y1Out = y2Out;
      if (x1Next === x2Next) {
        x2Out = x1Out;
        if ((x2Next - x2Out) * (x2Next - x2Next2) * (y2Next - y1Next) < 0) {
          y2Out = y2Next + 0.1;
        } else {
          y2Out = y2Next - 0.1;
        }
      } else {
        y2Out = y1Out;
        if ((y2Next - y2Out) * (y2Next - y2Next2) * (x2Next - x1Next) < 0) {
          x2Out = x2Next + 0.1;
        } else {
          x2Out = x2Next - 0.1;
        }
      }
      outsideEdges.push({ x1: x1Out, y1: y1Out, x2: x2Out, y2: y2Out });
    }
  }

  function intersects(x1, y1, x2, y2, outsideEdges) {
    for (let edge of outsideEdges) {
      if (
        segmentsIntersect(x1, y1, x2, y2, edge.x1, edge.y1, edge.x2, edge.y2)
      ) {
        return true;
      }
    }
    return false;
  }

  function segmentsIntersect(x1, y1, x2, y2, x3, y3, x4, y4) {
    if ((x1 === x2 && x3 === x4) || (y1 === y2 && y3 === y4)) {
      return false;
    }
    if (x1 === x2) {
      let minY = Math.min(y1, y2);
      let maxY = Math.max(y1, y2);
      let minX = Math.min(x3, x4);
      let maxX = Math.max(x3, x4);
      return x1 > minX && x1 < maxX && y3 < maxY && y3 > minY;
    } else {
      let minX = Math.min(x1, x2);
      let maxX = Math.max(x1, x2);
      let minY = Math.min(y3, y4);
      let maxY = Math.max(y3, y4);
      return y1 >= minY && y1 <= maxY && x3 < maxX && x3 > minX;
    }
  }

  let dataset = [];

  dataset.push({
    input: `7,1
11,1
11,7
9,7
9,5
2,5
2,3
7,3`,
    output: 24,
  });

  dataset.push({
    input: `98302,50003
98302,51224
98168,51224
98168,52447
98186,52447
98186,53636
97714,53636
97714,54871
97875,54871
97875,56010
97164,56010
97164,57213
97068,57213
97068,58476
97274,58476
97274,59728
97321,59728
97321,60896
96940,60896
96940,62063
96580,62063
96580,63178
96044,63178
96044,64395
95871,64395
95871,65536
95443,65536
95443,66593
94793,66593
94793,67818
94599,67818
94599,68765
93720,68765
93720,69885
93270,69885
93270,70946
92694,70946
92694,72389
92855,72389
92855,73409
92168,73409
92168,74440
91512,74440
91512,75135
90319,75135
90319,76590
90340,76590
90340,77609
89661,77609
89661,78603
88946,78603
88946,79150
87653,79150
87653,80056
86856,80056
86856,80969
86069,80969
86069,82283
85727,82283
85727,82920
84627,82920
84627,83969
83964,83969
83964,84620
82904,84620
82904,85831
82367,85831
82367,86713
81513,86713
81513,87151
80288,87151
80288,87866
79306,87866
79306,88852
78525,88852
78525,89142
77239,89142
77239,89703
76163,89703
76163,90454
75211,90454
75211,91706
74547,91706
74547,92126
73378,92126
73378,92726
72314,92726
72314,93055
71115,93055
71115,93445
69958,93445
69958,93971
68866,93971
68866,94264
67677,94264
67677,95294
66771,95294
66771,95514
65553,95514
65553,96011
64432,96011
64432,96160
63204,96160
63204,96700
62088,96700
62088,97050
60914,97050
60914,96668
59587,96668
59587,97561
58520,97561
58520,97113
57214,97113
57214,97472
56042,97472
56042,97372
54813,97372
54813,98058
53656,98058
53656,97675
52414,97675
52414,98174
51217,98174
51217,97538
49996,97538
49996,97777
48785,97777
48785,97710
47577,97710
47577,97588
46372,97588
46372,98126
45102,98126
45102,97628
43930,97628
43930,97893
42659,97893
42659,96979
41576,96979
41576,97336
40268,97336
40268,96764
39144,96764
39144,96153
38046,96153
38046,96044
36821,96044
36821,96133
35522,96133
35522,95129
34570,95129
34570,94715
33435,94715
33435,94476
32230,94476
32230,94173
31039,94173
31039,93855
29845,93855
29845,93309
28751,93309
28751,92364
27866,92364
27866,91768
26813,91768
26813,90974
25875,90974
25875,90656
24654,90656
24654,90390
23376,90390
23376,89775
22311,89775
22311,88714
21567,88714
21567,88174
20446,88174
20446,87381
19515,87381
19515,86667
18517,86667
18517,85391
18020,85391
18020,84587
17117,84587
17117,84173
15821,84173
15821,83232
15034,83232
15034,82204
14349,82204
14349,81581
13206,81581
13206,80333
12794,80333
12794,79174
12304,79174
12304,78538
11129,78538
11129,77208
10902,77208
10902,76567
9682,76567
9682,75520
9049,75520
9049,74331
8659,74331
8659,73210
8176,73210
8176,72066
7748,72066
7748,71330
6507,71330
6507,70084
6280,70084
6280,68785
6215,68785
6215,67814
5393,67814
5393,66621
5112,66621
5112,65682
4109,65682
4109,64454
3918,64454
3918,63076
4289,63076
4289,62035
3502,62035
3502,60858
3190,60858
3190,59573
3400,59573
3400,58531
2382,58531
2382,57313
2238,57313
2238,56105
2034,56105
2034,54836
2406,54836
2406,53666
1803,53666
1803,52448
1646,52448
1646,51221
1674,51221
1674,50003
94601,50003
94601,48785
2222,48785
2222,47553
1818,47553
1818,46337
1944,46337
1944,45177
2609,45177
2609,43968
2666,43968
2666,42764
2790,42764
2790,41575
3015,41575
3015,40249
2568,40249
2568,39132
3184,39132
3184,37906
3307,37906
3307,36927
4324,36927
4324,35567
4011,35567
4011,34363
4265,34363
4265,33197
4640,33197
4640,32194
5435,32194
5435,31142
6065,31142
6065,30099
6695,30099
6695,28705
6596,28705
6596,27761
7433,27761
7433,26844
8288,26844
8288,25449
8300,25449
8300,24396
8928,24396
8928,23840
10314,23840
10314,22721
10814,22721
10814,21729
11506,21729
11506,20366
11722,20366
11722,19560
12674,19560
12674,18574
13398,18574
13398,17557
14096,17557
14096,17268
15571,17268
15571,15972
15976,15972
15976,15218
16942,15218
16942,14403
17844,14403
17844,13244
18451,13244
18451,13003
19837,13003
19837,12032
20615,12032
20615,11292
21581,11292
21581,10689
22643,10689
22643,10214
23783,10214
23783,9256
24608,9256
24608,8332
25475,8332
25475,7886
26628,7886
26628,7649
27881,7649
27881,7321
29068,7321
29068,6086
29826,6086
29826,6310
31254,6310
31254,5316
32154,5316
32154,4703
33227,4703
33227,4507
34453,4507
34453,4398
35695,4398
35695,3408
36672,3408
36672,3522
37969,3522
37969,3685
39256,3685
39256,3353
40417,3353
40417,2886
41559,2886
41559,2933
42793,2933
42793,2141
43908,2141
43908,2680
45191,2680
45191,2586
46392,2586
46392,2000
47569,2000
47569,2086
48789,2086
48789,1768
50003,1768
50003,2094
51217,2094
51217,1726
52451,1726
52451,2521
53618,2521
53618,2184
54865,2184
54865,2001
56116,2001
56116,2192
57327,2192
57327,2984
58430,2984
58430,2640
59735,2640
59735,3676
60752,3676
60752,3891
61941,3891
61941,4311
63076,4311
63076,4651
64231,4651
64231,4383
65595,4383
65595,4870
66717,4870
66717,5195
67900,5195
67900,6130
68829,6130
68829,6542
69971,6542
69971,6459
71361,6459
71361,7583
72160,7583
72160,7855
73395,7855
73395,8368
74511,8368
74511,9474
75263,9474
75263,9687
76572,9687
76572,10635
77402,10635
77402,11650
78164,11650
78164,11759
79604,11759
79604,12930
80230,12930
80230,13733
81138,13733
81138,14741
81859,14741
81859,15311
82978,15311
82978,16332
83672,16332
83672,17169
84542,17169
84542,17714
85740,17714
85740,18612
86566,18612
86566,19436
87488,19436
87488,20859
87651,20859
87651,21393
88962,21393
88962,22570
89415,22570
89415,23635
90009,23635
90009,24534
90862,24534
90862,25593
91467,25593
91467,26849
91716,26849
91716,27581
92925,27581
92925,28721
93386,28721
93386,29770
94036,29770
94036,31222
93764,31222
93764,32377
94126,32377
94126,33274
95169,33274
95169,34393
95668,34393
95668,35730
95490,35730
95490,36882
95855,36882
95855,38072
96081,38072
96081,39252
96327,39252
96327,40429
96585,40429
96585,41595
96912,41595
96912,42771
97206,42771
97206,43958
97461,43958
97461,45166
97568,45166
97568,46336
98146,46336
98146,47589
97604,47589
97604,48791
97828,48791
97828,50003`,
    output: 1588990708,
  });

  Utils.check(solve, dataset, "9b");
})();
