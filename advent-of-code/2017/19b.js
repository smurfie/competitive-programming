(() => {
  function solve(input) {
    var lines = Utils.read(input);
    var matrix = [];

    for (var line of lines) {
      matrix.push(line.split(""));
    }

    var x = 0;
    var y = matrix[0].indexOf("|");
    var direction = "d";
    var finish = false;
    var text = "";
    var steps = 0;

    while (!finish) {
      steps++;
      var char = matrix[x][y];
      if (char == "+") {
        if (direction == "l" || direction == "r") {
          if (matrix[x - 1][y] != " ") {
            direction = "u";
            x--;
          } else {
            direction = "d";
            x++;
          }
        } else {
          if (matrix[x][y - 1] != " ") {
            direction = "l";
            y--;
          } else {
            direction = "r";
            y++;
          }
        }
      } else {
        if (char != " " && char != "-" && char != "|") text += char;
        if (char == " ") finish = true;
        else {
          if (direction == "d") x++;
          else if (direction == "u") x--;
          else if (direction == "l") y--;
          else if (direction == "r") y++;
        }
      }
    }

    return --steps;
  }

  var dataset = [];

  dataset.push({
    input: `     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ `,
    output: 38
  });

  dataset.push({
    input: `                                                               |                                                                                                                                         
       +-------------------------------------------------------|-----------------------------+ +-------+ +-------+           +-+   +-------------------------------------------------------------+       
       |                                                       |                             | |       | |       |           | |   |                                                             |       
       |     +-------+                     +---------------+   |                     +-------|---------|-+       |         +-|-----------------------------------------+                         |       
       |     |       |                     |               |   |                     |       | |       |         |         | | |   |                                   |                         |       
       |     |       +---------------------|-----------------------------------------|-------|-----+   |         |         | +-|---+                         +-----------------------------------------+ 
       |     |                             |               |   |                     |       | |   |   |         |         |   |                             |         |                         |     | 
       |     | +---------------------------|---+ +-------+ +---|---+               +-|-------|-------------------------------+ |                             |         |                     +-+ |     | 
       |     | |                           |   | |       |     |   |               | |       | |   |   |         |         | | |                             |         |                     | | |     | 
   +---------|---------------------------------|---------|---------|---------------|---------------|---|-------------------|-|-------------------------------|-------+ |                     | | |     | 
   |   |     | |                           |   | |       |     |   |               | |       | |   |   |         |         | | |                             |       | |                     | | |     | 
   |   +-----|-------------------------------------------------|---|---------------------------|-------|-------------------------------------------------------------------------------+     | | |     | 
   |         | |                           |   | |       |     |   |               | |       | |   |   |         |         | | |                             |       | |               |     | | |     | 
   |         | |                           |   +---------|-----|---+               | |       | | +-----+         |     +---|-+ +-----------------------------|---------|---------------|-----|-----+   | 
   |         | |                           |     |       |     |                   | |       | | | |             |     |   |                                 |       | |               |     | | | |   | 
   |         | |                           |   +-+ +-----------|-----------+       | |       | | +-------------+ |     |   |                     +-------------------+ |               | +-----|---|---+ 
   |         | |                           |   |   |     |     |           |       | |       | |   |           | |     |   |                     |           |         |               | |   | | | |     
   |         | |                       +-------|---|-----------|-----------|-------------------|---|-------------|-------------------------------|-----------|---------|---------------+ |   | | | |     
   |         | |                       |   |   |   |     |     |           |       | |       | |   |           | |     |   |                     |           |         |                 |   | | | |     
   |         | |                       |   |   |   +-----|-----------------|-----------------|-+   |           | |     |   |                     |           |         |                 |   | | | |     
   |         | |                       |   |   |         |     |           |       | |       |     |           | |     |   |                     |           |         |                 |   | | | |     
   |         | |                       |   |   |         |   +-+           |       | |       |     |           | |     |   |                     |           |         |                 |   | | | |     
   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |                     |           |         |                 |   | | | |     
   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |                     |           |         |   +-+           |   | | | |     
   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |                     |           |         |   | |           |   | | | |     
   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |   +-----------------|-----------|-----+   |   | |           |   | | | |     
   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |   |                 |           |     |   |   | |           |   | | | |     
   +-+ +-------------------------------+   |   +---------|-----------------|-------|---------------------------|---------------|-------+         |           |     |   |   | |           |   | | | |     
     | |     | |                           |             |   |             |       | |       |     |           | |     |   |   |       |         |           |     |   |   | |           |   | | | |     
   +-|-|---+ | |         +---------------+ |   +-------------|-------------|---------+       |     |   +---------|---------|---|---------------+ |           |     |   |   | |     +-----|-------------+ 
   | | |   | | |         |               | |   |         |   |             |       |         |     |   |       | |     |   |   |       |       | |           |     |   |   | |     |     |   | | | |   | 
 +-+ | |   +---------------------+       | |   | +-------------------------|-----------------+     |   |       | |     |   |   |       |       | |           |     |   |   | |     |     +---+ | | |   | 
 |   | |     | |         |       |       | |   | |       |   |             |       |               |   |       | |     |   |   |       |       | |           |     |   |   | |     |           | | |   | 
 | +-|-|-----------------|-----------------|---|-|-------|---|---------------------|---------------|---|-------|---------------------------------|-------------------+ |   | |     |           | | |   | 
 | | | |     | |         |       |       | |   | |       |   |             |       |               |   |       | |     |   |   |       |       | |           |     | | |   | |     |           | | |   | 
 | | | |     | |         |       |       | |   | +---------------------------------|-------+       |   |       | |     |   |   |       |       | |           |     | | |   | |     +-----------+ | |   | 
 | | | |     | |         |       |       | |   |         |   |             |       |       |       |   |       | |     |   |   |       |       | |           |     | | |   | |                   | |   | 
 | | | |     | |         |       |       | |   |         |   |             |       |       |   +---|-----------|-|-----+   |   |       +-------|-------------------+ | |   | |                   | |   | 
 | | | |     | |         |       |       | |   |         |   |             |       |       |   |   |   |       | |         |   |               | |           |       | |   | |                   | |   | 
 +-|-----+   | |         |     +-|-------|-----|-------------|-------------|---------------------------|-------|-----------|---|---------------|-|-----------------+ | |   | |                   | |   | 
   | | | |   | |         |     | |       | |   |         |   |             |       |       |   |   |   |       | |         |   |               | |           |     | | |   | |                   | |   | 
 +-------+ +-|-|---+     |     | |       | |   |         |   |             |       |       |   |   |   |   +---|---------------|---------------|---------------+   | | |   | |                   | |   | 
 | | | |   | | |   |     |     | |       | |   |         |   |             |       |       |   |   |   |   |   | |         |   |               | |           | |   | | |   | |                   | |   | 
 | +-|-|-+ | | |   |     |     | +-------|-|---|-------+ |   |             |       |       |   |   |   |   |   | |         |   |               | |           | |   | | |   | |                   | |   | 
 |   | | | | | |   |     |     |         | |   |       | |   |             |       |       |   |   |   |   |   | |         |   |               | |           | |   | | |   | |                   | |   | 
 | +---|---|-|-+ +-------|-----|-----------|---|-------------|-------------|---------------|-----------|-------|-|-------------|-----------+   | | +-------------------|-----|-+                 | |   | 
 | | | | | | |   | |     |     |         | |   |       | |   |             |       |       |   |   |   |   |   | |         |   |           |   | | |         | |   | | |   | | |                 | |   | 
 | +-+ | | +-|-----|-----------|---------|-|---|-------+ |   |       +---------+   |       |   |   |   |   |   | |         |   +-----------|-----|-----------------|-----------|-+               | |   | 
 |     | |   |   | |     |     |         | |   |         |   |       |     |   |   |       |   |   |   |   |   | |         |               |   | | |         | |   | | |   | | | |               | |   | 
 |     | | +-----|-------------|---------|-----|---------------------------|-----------------------|-------|-----------------------------+ |   | | |         | |   | | |   | | | |               | |   | 
 |     | | | |   | |     |     |         | |   |         |   |       |     |   |   |       |   |   |   |   |   | |         |             | |   | | |         | |   | | |   | | | |               | |   | 
 |     | | | |   | |     |     |         | |   +---------|---|-------+     |   |   |       |   |   |   |   |   | |         |             | |   | | |     +---+ |   | | |   | | | |               | |   | 
 |     | | | |   | |     |     |         | |             |   |             |   |   |       |   |   |   |   |   | |         |             | |   | | |     |     |   | | |   | | | |               | |   | 
 +---+ | | | +---|-|-----|-----|-------------------------|---|-------------|-------|-------|-------|---|-------|-|---------|-------------|-|---|---|---+ |     |   | | |   | | | |               | |   | 
     | | | |     | |     |     |         | |             |   |             |   |   |       |   |   |   |   |   | |         |             | |   | | |   | |     |   | | |   | | | |               | |   | 
     | | | |     | |     |     |         | |             | +---------------|---|-------------------|-----------+ |         |             | |   | | |   | |     |   | | |   | | | |       +---+   | |   | 
     | | | |     | |     |     |         | |             | | |             |   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | 
     | | | |   +---------|-----|---------|-----------------|-|---------+   |   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | 
     | | | |   | | |     |     |         | |             | | |         |   |   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | 
     | | | |   +-|-|-----------|---------|---------------+ +-|---+ +-------+   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | 
     | | | |     | |     |     |         | |                 |   | |   |       |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | 
     | | | |     | |     |     |         | |                 |   | |   |     +-------------|-------|---|---------|---------|-------------|-|---|-|-|-----------|---|-------+ | | +-------|---|---|-|---+ 
     | | | |     | |     |     |         | |                 |   | |   |     | |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |     | |         |   |   | |     
     | | | |     | |     |     |         | |                 |   | |   |     | |   |       |   |   |   +-----------------------------------|---|-|---------------+ | | |     | |         |   |   | |     
     | | | |     | |     |     |         | |                 |   | |   |     | |   |       |   |   |       |     |         |             | |   | | |   | |     | | | | |     | |         |   |   | |     
     | | | |   +-|-|-----------|-------+ | |                 |   | | +-|-----|-----------------|---|-------|-----|---------|-------------|-|---|---|---|-----------|-|-|-----|-------------+ |   | |     
     | | | |   | | |     |     |       | | |                 |   | | | |     | |   |       |   |   |       |     |         |             | |   | | |   | |     | | | | |     | |         | | |   | |     
     | | | |   | | |     |     |       | | |                 |   | | | | +-------+ |       |   |   |       |     |         |             | |   | | |   | |     | | +---|-----|-|---+     | | |   | |     
     | | | |   | | |     |     |       | | |                 |   | | | | |   | | | |       |   |   |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     
     | | | |   | | |     |     |       | | |                 | +---+ +---|---|---|---------|---+   |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     
     | | | |   | | |     |     |       | | |                 | | |     | |   | | | |       |       |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     
     | | | |   | | |   +-|-----------------|-----------------|-|-----+ | |   | | | |       |       |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     
     | | | |   | | |   | |     |       | | |                 | | |   | | |   | | | |       |       |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     
     | | | |   | | |   +-|-------+     +---|-----------------|---|-+ | | |   | | | | +-----|-------|-------------|---------|-------------|-|-----|-|-----|---+ | |   | |     | |   |     | | |   | |     
     | | | |   | | |     |     | |       | |                 | | | | | | |   | | | | |     |       |       |     |         |             | |   | | |   | |   | | |   | |     | |   |     | | |   | |     
     | | | | +-|---|-------------------+ | |             +-------+ | | | |   | | | | | +---|---------------------|---------|-------------|-|---|---|---+ |   | | |   | |     | |   |     | | |   | |     
     | | | | | | | |     |     | |     | | |             |   | |   | | | |   | | | | | |   |       |       |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     
     | | | | | | | |   +-+     | |   +-|---|-------------|---|-----|-|-|-|---|-|---|-|-|---|-------+       |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     
     | | | | | | | |   |       | |   | | | |             |   | |   | | | |   | | | | | |   |               |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     
     | | | | | | | |   +---------|-------|-|-------------|-----+   | | | |   | | | | | |   |               |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     
     | | | | | | | |           | |   | | | |             |   |     | | | |   | | | | | |   |               |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     
     | | | | | | | |           | |   | | | |             |   |     | | +-|-------|-|-----------------------|---+ |         |       +---------------|---------|-|-|-----------|-----|-----|-|-|-----|---+ 
     | | | | | | | |           | |   | | | |             |   |     | |   |   | | | | | |   |               |   | |         |       |     | |   | | |     |   | | |   | |     | |   |     | | |   | |   | 
   +-|---------|-|-------------------|-----|-------------|---|-----|-|---|-----|-|-----|-------------------|---|-|---------|-------------------|-|-+     |   +---------|-------|-+ |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | |   |   | | | | | |   |               |   | |         |       |     | |   | |       |     | |   | |     | | | |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | | +-----|---|-|-----+ |               |   | |         |       |     | |   | |       |     | |   | | +-----|-+ |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | | | | | | |               |   | |         |       |     | |   | |       |     | |   | | |   | |   |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | | +---|-|-|---------------------------------------------------|-----------+   | |   | | |   | |   |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | |       | |   | |   | | |   | |   |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | +-+   | |   | |   | | |   | |   |     | | |   | |   | 
   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | | |   | |   | |   | | |   | |   |     | | |   | |   | 
   | | | | | | | | |   +---------|---|-|-|-+             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | | |   | |   | |   | | |   | |   |     | | |   | |   | 
   | | | | | | | | |   |       | |   | | |               |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | | |   | |   | |   | | |   | |   |     | | |   | |   | 
   | | | | | | +---|---|-------------|-|---------------------|-------|-|-|---|---|---|---------------------|---|-----------|-------|-----|-|-----|-+ |   +-|-+ | |   | | |   | |   |     | | |   | |   | 
   | | | | | |   | |   |       | |   | | |               |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | |   |     | | | |   | | |   | |   |     | | |   | |   | 
   | | | | | |   | | +-------+ +-----|-|-----------------------+   | | | |   | | |   | | | |               |   | +---------|-------------|-----|-|-----------|---|-+ | | |   | |   |     | | | +-----+ | 
   | | | | | |   | | | |     |   A   | | |               |   | |   | | | |   | | |   | | | |               |   |           |       |     | |   | |   |     | | | | | | | |   | |   |     | | | | | | | | 
   | | | | | |   | | | |     |   |   +-|-----------------|-----|-------|-|-------|---|-|---|-------------------|-----------|-------|-----|-----------|-------|-----|-|-|-----|-----------|---------|-+ | 
   | | | | | |   | | | |     |   |     | |               |   | |   | | | |   | | |   | | | |               |   |           |       |     | |   | |   |     | | | | | | | |   | |   |     | | | | | |   | 
   | | | | | |   +-|---------|---|-------|-------------------|---------|-|---|-|-----|---+ |               |   |           |       |     | |   | | +-------|-+ | | | | | |   | |   |     | | | | | |   | 
   | | | | | |     | | |     |   |     | |               |   | |   | | | |   | | |   | |   |               |   |           |       |     | |   | | | |     |   | | | | | |   | |   |     | | | | | |   | 
   | | | | | |     | | |     |   |     | |               |   | |   | | | |   | | |   | |   |               | +-|---------------------------|-------|-|-----+ +-----+ | | |   | | +-------|-----|-|-|-+ | 
   | | | | | |     | | |     |   |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |       | | |   | | |   | | | |     | | | | | | | | 
   | | | | | |     | +-|-+   +---------|-|-------------------|-|---|---|-|---|---------|---------------------|-------------|-------|-----|-------|-|---------+ | |   | | |   | | | |     | | | | | | | | 
   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |         | |   | | |   | | | |     | | | | | | | | 
   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |   +-------|---|-----+ | | | |     | | | | | | | | 
   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |   |     | |   | | | | | | | |     | | | | | X | | 
   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   | +---------------|-|-------------------|-----------|---+ |   |     | |   | | | | | | | |     | | | | | | | | 
   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | | | | | | | |     | | | | | | | | 
   | | | | | |     |   | |       |     | |               +---|-|-----|---|-----------|-|-------------------------------------------|-------------|-------------|-----|-|-+ | | | | |     | | | | | | | | 
   | | | | | |     |   | |       |     | |                   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | |   | | | | |     | | | | | | | | 
 +-|---------|-----------------+ |     | |                   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | |   | | | | |     | | | | | | | | 
 | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | |   | | | | |     | | | | | | | | 
 | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | +---------|-------|-----|-|-+ | |   |   |     | |   | |   | | | | |     | | | | | | | | 
 | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |       |     | | | | |   |   |     | |   | |   | | | | |     | | | | | | | | 
 | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |     +-|-------|---|-----|---|-----------|-----+ | | | |     | | | | | | | | 
 | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |     | |     | | | | |   |   |     | |   | |     | | | |     | | | | | | | | 
 | | | +-----------|---|-|-----|-|-----|---------------------------|-|-|-|---|-|-|---|-------|-----------------|-|---------|-----|-------+ | | | |   |   |   +-------|-----+ | | | |     | | | | | | | | 
 | | |   | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |     | |       | | | |   |   |   | | |   | |   | | | | |     | | | | | | | | 
 +-------|-|---------------------|---------------------------------|-----|---|-|-----|-----|-+             | | | |         |     | |     +---|-+ +---+   |   | +-|---|-----|---|---|-+   | | | | | | | | 
   | |   | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   |               | | | |         |     | |     | | |           |   |   |   | |   | | | | | |   | | | | | | | | 
   | |   | | |     |   | |     | |     | | +-+           +---|-|---+ | | | +-|---+   | |   |               | | | |         |     | |     | | |         +-|---|---|---------|---|-----+   | | | | | | | | 
   | |   | | |     |   | |     | |     | | | |           |   | |     | | | | | |     | |   |               | | | |         |     | |     | | |         | |   |   |   | |   | | | | |     | | | | | | | | 
   +-|-----|-|-----|---|-|-------------|-|-------------+ |   | |     | | | | | |     | |   |   +-----------|-|-------------|-----------------|---------|-|-------|---|-----|-+ | | +-+   | | | | | | | | 
     |   | | |     |   | |     | |     | | | |         | |   | |     | | | | | |     | |   |   |           | | | |         |     | |     | | |         | |   |   |   | |   |   | |   |   | | | | | | | | 
     |   | | |     |   | |   +-|-------+ | | |         | |   | |     | | | | | +-----|-|-------|-----------|-|-------------------|-|-------|-----------+ |   |   |   | |   |   | |   |   | | | | | | | | 
     |   | | |     |   | |   | | |       | | |         | |   | |     | | | | |       | |   |   |           | | | |         |     | |     | | |           |   |   |   | |   |   | |   |   | | | | | | | | 
 +-+ |   +---------|-----|---|-----------|---|-----------|---|-|-----------|-|-------|---------|-----+     | | | |         |     | |     | | |           |   |   +---|-|---|---------+   | | | | | | | | 
 | | |     | |     |   | |   | | |       | | |         | |   | |     | | | | |       | |   |   |     |     | | | |         |     | |     | | |           |   |       | |   |   | |       | | | | | | | | 
 +---|-----|-----+ |   | |   | | |       | | |         | |   | |     | | | | +-------|-------------+ |     | | | |         |     | |     | | |           |   |       | |   |   | |       | | | | | | | | 
   | |     | |   | |   | |   | | |       | | |         | |   | |     | | | |         | |   |   |   | |     | | | |         |     | |     | | |           |   |       | |   |   | |       | | | | | | | | 
 +---|-----------------|-----|-|-----------|-----------|-|---|-------|---|-|---------|-|-----------|-------------|---------------|-|-----|-|-------------|-----------+ |   |   | |       | | | | | | | | 
 | | |     | |   | |   | |   | | |       | | |         | |   | |     | | | |         | |   |   |   | |     | | | |         |     | |     | | |           |   |         |   |   | |       | | | | | | | | 
 | | |     | |   | |   | |   | | |       | | |         | |   +-------|-+ | |         | +---|---------+     | | | |         |     | |     | | |         +-|-----------------------|-----------|---|---+ | 
 | | |     | |   | |   | |   | | |       | | |         | |     |     |   | |         |     |   |   |       | | | |         |     | |     | | |         | |   |         |   |   | |       | | | | | |   | 
 +-|-|-------|-----|---|-----|---|-------|-|-----------|-------------|---|-----------------|---------------|-|-|-----+     |     | |     | +-----------|-+   |         | +-|---------+   | | | | | |   | 
   | |     | |   | |   | |   | | |       | | |         | |     |     |   | |         |     |   |   |       | | | |   |     |     | |     |   |         |     |         | | |   | |   |   | | | | | |   | 
   | |   +-|-----|-----+ |   | | |       | | |         | |     |     |   | |       +-|-------------|------------Z|---|-----------------------+         |     |         | | |   | |   |   | | | | | |   | 
   | |   | | |   | |     |   | | |       | | |         | |     |     |   | |       | |     |   |   |       | | | |   |     |     | |     |             |     |         | | |   | |   |   | | | | | |   | 
   | |   | | |   | |     | +-+ | +-----------------------------|-----|-----|---------------|---|---------------|-----+     |     | +-------------------|-----------------|-|---|-|-------|-|-+ | | |   | 
   | |   | | |   | |     | |   |         | | |         | |     |     |   | |       | |     |   |   |       | | | |         |     |       |             |     |         | | |   | |   |   | |   | | |   | 
 +-|-+   | | |   | |     | |   | +---------------------+ |     |     |   | |       | |     |   +---|-------|-|-------------|-------------|-------------|-----|-------------|-----|-----+ | |   | | |   | 
 | |     | | |   | |     | |   | |       | | |           |     |     |   | |       | |     |       |       | | | |         |     |       |             |     |         | | |   | |   | | | |   | | |   | 
 | |     | | |   | |     | |   | |   +---|-+ |           |     |     |   | |       | |     |       |       | | | |         |     |       |             |     |         | | |   | |   | | | |   | | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |     |   | |       | |     |       |       | | | |         |     |       |             |     |         | | |   | |   | | | |   | | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |     +---|---------|-|-------------|---------|-|-|-------------------------------------|-----|---+     | | |   | +-----|-------+ | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |     | | |   |     | | | |     | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |     +-------|-----+ +-------+ | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 | +-----+ | |   | |     | +---|-----|-------|---------------------------|-+       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 |         | |   | |     |     | |   |   |   |           |     |         |         | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | 
 | +---------|-----|-----|-----|-+   |   |   |           |     +---------------------------|-------|-------|-|-|-----+     |     |       |             |     |   |       | |   |         | |   | | |   | 
 | |       | |   | |     |     |     |   |   |           |               |         | |     |       |       | | | |   |     |     |       |             |     |   |       | |   |         | |   | | |   | 
 | |       | |   | |     |     |     |   |   |           |               |         | |     |       |       | | | |   |     |     |       +-------------|--I--------+     | |   |         | |   | | |   | 
 | |       | |   | |     |     |     |   |   |           |               |         | |     |       |       | | | |   |     |     |                     |     |   | |     | |   |         | |   | | |   | 
 | |       | |   | |     |     |     |   |   |         +-----------------+         | |     |       |       | | | |   |     |     |                     |     |   | |     | |   |         | |   | | |   | 
 | |       | |   | |     |     |     |   |   |         | |                         | |     |       |       | | | |   |     |     |                     |     |   | |     | |   |         | |   | | |   | 
 | |       | |   | |     | +---|-------------------------|---------------------------|-----|---+   |       | | | |   |     |     |                     |     |   | |     | +-+ |     +-+ | |   | | |   | 
 | |       | |   | |     | |   |     |   |   |         | |                         | |     |   |   |       | | | |   |     |     |                     |     |   | |     |   | |     | | | |   | | |   | 
 | |       | |   | |     | |   |     |   | +-|---------|-|---------------------------|-----|---+   |       | | | |   |     |     |                     |     |   +-----------|-|-----+ | | |   | | |   | 
 | |       | |   | |     | |   |     |   | | |         | |                         | |     |       |       | | | |   |     |     |                     |     |     |     |   | |       | | |   | | |   | 
 +-|-------------|---------|---------|---|-|-|---------|-|---------------------------------|-------|-------|-|-------------------------------------+ +-|-----|---------------|-|---+   | | |   | | |   | 
   |       | |   | |     | |   |     |   | | |         | |                         | |     |       |       | | | |   |     |     |                 | | |     |     |     |   | |   |   | | |   | | |   | 
   |       | |   | |     | |   |     |   +---+         | +---------------------------------|---------------|-----------------------------------+   +-|-----------------------------+   | | |   | | |   | 
   |       | |   | |     | |   |     |     |           |                           | |     |       |       | | | |   |     |     |             |     | |     |     |     |   | |       | | |   | | |   | 
   |       | +-+ +-------------------|-----|---------------+                       | |     |   +---|-------|-|---|---|-----------|-------------|-----|-+     |   +-+     |   | |       | | |   | | |   | 
   |       |   |   |     | |   |     |     |           |   |                       | |     |   |   |       | | | |   |     |     |             |     |       |   |       |   | |       | | |   | | |   | 
   |       |   |   +-----+ +---------|-----------------|---|-----------------------+ |     |   |   +-----------|-|---|-------------------------------|-------|-----------|-------------+ | |   | | |   | 
   |       |   |               |     |     |           |   |                         |     |   |           | | | |   |     |     |             |     |       |   |       |   | |         | |   | | |   | 
   +-------|---|---------------------------|---------------------------------------------------|---------------|-|---|-----------|-------------+     |       |   |       |   | |         | |   | | |   | 
           |   |               |     |     |           |   |                         |     |   |           | | | |   |     |     |                   |       |   |       |   | |         | |   | | |   | 
           +-------------------|-----|-----|---------------|-----------------------------------|-------------|-------------------|-------------------|-------|---------------|-|---------|-----|-+ |   | 
               |               |     |     |           |   |                         |     |   |           | | | |   |     |     |                   |       |   |       |   | |         | |   |   |   | 
               |         +-----------------|-----------+   |                         |     |   |           | | | |   |     |     |                   +-------|---|-----------------+     | |   |   |   | 
               |         |     |     |     |               |                         |     |   |           | | | |   |     |     |                           |   |       |   | |   |     | |   |   |   | 
               |         +-----------|U----|---------------+                         |     |   |           | | | |   |     |     |                           |   |       +-----|---|-------|---|-------+ 
               |               |     |     |                                         |     |   |           | | | |   |     |     |                           |   |           | |   |     | |   |   |     
             +-|---------------------|-----------------------------------------------|-+   |   |           | | | |   |     |     |                           |   |           | |   |     | |   |   |     
             | |               |     |     |                                         | |   |   |           | | | |   |     |     |                           |   |           | |   |     | |   |   |     
             | |               |     |     |                                         | |   |   |           | | | |   |     |     |                         +-----+           | |   |     | |   |   |     
             | |               |     |     |                                         | |   |   |           | | | |   |     |     |                         | |               | |   |     | |   |   |     
             | |               |     |     |           +-----------------------------|-----|---|--------S--|-|---|---------------|---------------------------|---------------+ | +-+     +-|-------+     
             | |               |     |     |           |                             | |   |   |           | | | |   |     |     |                         | |                 | |         |   |         
             | |               |     |     |           |                             | |   |   |           | +-------------+     +---------------------------+               +---+         |   |         
             | |               |     |     |           |                             | |   |   |           |   | |   |                                     |                 | |           |   |         
             | |               |     |     |         +-|-----------------------------|-----|---|-----------|-----|-------------------------------------------+     +---------|-|-----------------------+ 
             | |               |     |     |         | |                             | |   |   |           |   | |   |                                     | |     |         B |           |   |       | 
   +---------|-|---------------------|-----------------------------------------------|-+   | +-----------------------|---------------------------------------------|-----------------+     |   |       | 
   |         | |               |     |     |         | |                             |     | | |           |   | |   |                                     | |     |         | |     |     |   |       | 
 Y +---------|-----------------------+     +-----------------------------------------+     +-|-------------|-----|---|---------------------------------------|-----|-----+ +-+ +-+   |     |   |       | 
 |           | |               |                     | |                                     | |           |   | |   |                                     | |     |     | |     |   |     |   |       | 
 |           | |               |   +-----------------+ +-------------------------------------+ |           |   +-+   +-------------------------------------|-|-------------|-----|-------+ |   |       | 
 |           | |               |   |                                                           |           |                                               | |     |     | |     |   |   | |   |       | 
 |       +---+ |               |   |                                                           +--------------------------------------------W----------------|-----|-----+ +-----+   +-----+   +-------+ 
 |       |     |               |   |                                                                       |                                               | |     |                     |               
 +-------+     +---------------+   +-----------------------------------------------------------------------+                                               +-+     +---------------------+               
                                                                                                                                                                                                         `,
    output: 16676
  });

  Utils.check(solve, dataset, "19b");
})();
